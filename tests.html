<html>
    <head>
        <title>Yes script tests</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
		<script src="yes.js"></script>
		<style>
			.shock{
				background-color:#dfd;
			}
		</style>
    </head>
    <body>
        <div class = 'wrapper'>
            <div>
                See the line starting with //tests to see what is going on.<br>
                This div has no class.<br>
                These do:
            </div>
            <div class = 'd1 allDivs' id = 'div-d1'>
				blah1 
            </div>

            <div class = 'd2 allDivs' id = 'div-d2' data-da = 'test data A val' data-db = 'test data B val'>
				blah2
				<div class = 'inside allDivs'>
					inside...
				</div>
            </div>

        </div>    

        <div class = 'allDivs'>
            outside wrapper
        </div>        

		<div id = 'logger'>

		</div>

		<script>
            (function () {
				
				
				class YaLog{
					
					constructor(){
						this.curStyle = null;
						//console.log('prototype:',this.prototype);
						//this['bleh'] = function(){return 'bleeeeeeeeeeeeeh';};
					}
					
					callConsoleMethod (method, ...args){
						console[method](...args);
					}
					
					log(){
						this.callConsoleMethod('log',...arguments);
					}
					info(){
						this.callConsoleMethod('info',...arguments);
					}
					error(){
						this.callConsoleMethod('error',...arguments);
					}
					group(){
						this.callConsoleMethod('group',...arguments);
					}
					
					
					/*
					 * 'gc' stands for 'group callback'.
					 * this just encapsulates code into groups in console:
					 */
					gc(groupName, callback, collapsed = false, style = ''){
						if(style){
							groupName = '%c' + groupName;	
						}
						if(collapsed){
							console.groupCollapsed(groupName,style);
						}else{
							console.group(groupName,style);
						};
						callback();
						console.groupEnd();
					}
				}
				
				let log = new YaLog();
				
				//other tests
				//console.log(log.bleh());
				console.log(log);
				log.log('blah','bleh', {a:6});
				
				/////////////////////////////////////////////////////////////////////////
				//inits
				
				var vanillaD2Elem = document.querySelector('.d2');
				console.log('vanillaD2Elem:',vanillaD2Elem);

                //These work fine:
                let yAllDivs = yes('.wrapper .allDivs');
                let yDiv2 = yes('.wrapper .d2');
				
				console.groupEnd();
                
				/////////////////////////////////////////////////////////////////////////
				console.groupCollapsed('Basics');

                //methods:
				
				log.logg('setAttribute',()=>{
					yes('.allDivs').setAttribute('style', 'text-decoration:underline');//OK
				});
				
				logg('getAttribute',()=>{
					console.log('result:', yAllDivs.getAttribute('style'));//OK
				});
				

				logg('chaining',()=>{
					//yAllDivs.setAttribute('style','border-left:3px solid red').
					//		setAttribute('title','title changed');//OK

				});

				
				//properties
				logg('setting simple prop, like .title',()=>{
	                yes('.allDivs').title = 'title changed 2';//OK
				});

				logg('setting prop.subProp, like style.color',()=>{
					yAllDivs.style.color = 'green';//OK!
					yDiv2.style.color = 'orange';//OK!
				});
				
				logg('playing with innerHTML',()=>{
					console.log('d2 reading:', yes('.d2').innerHTML);//OK
					yes('.d2 .inside').innerHTML = '<p>aaaaaaaaaaaaa</p>';//OK
				});
				
				logg('seting onclick event',()=>{
					yes('.allDivs').onclick = (event) => {
					 yes(event.target).style.color = 'brown';//ok!
					};//OK
				});
				
				console.groupEnd();//end of absolute basics
				
			
				/////////////////////////////////////////////////////////////////////////
				//Reading/writing props.subprops including methods like classList.add()
                
				console.groupCollapsed('Writing props.subprops');

                logg('adding classList.add',()=>{
					yAllDivs.classList.add('shock');//ok
				});

                logg('reading style.color:',()=>{
					console.log('result:', yDiv2.style.color);
				});	

                logg('reading string dataset',()=>{
					console.log('result:', yes('.d2').dataset.da);//ok
				});
				
                logg('reading string classname:', ()=>{
					console.log('result:', yAllDivs.className);
				});
	

                logg('setting and reading user prop', () => {
					vanillaD2Elem.userProp = {userSubProp: {userSubSubProp: 'user sub sub prop val'}};
					console.log('result:', yDiv2.userProp.userSubProp.userSubSubProp);
				});
				
				logg('setting and reading user prop', () => {
					//yDiv2.userProp = {userSubProp: {userSubSubProp: 'user sub sub prop val CHANGED'}};//OK
					yDiv2.userProp.userSubProp.userSubSubProp = 'CHANGED';
					console.log('result:', yDiv2.userProp.userSubProp.userSubSubProp);//ok!
				});
				
				
				
				console.groupEnd();//end of "Reading/writing props.subprops"
				
				/////////////////////////////////////////////////////////////////////////
				//Experiments with new stuff
                				
				console.group('Experiments with new stuff');
				
				logg('foreach', () => {
					yDiv2.forEach(elem => {
						elem.style.textShadow ='-2px -2px 2px #bbb';
					});//.style.paddingLeft = '30px';
				});
				
				logg('filtering:', () => {
					let filtered = yes(yAllDivs.filter(el => el.tagName === 'DIV'));
					filtered.style.border = '10px solid #aad';
				});
				
					
				console.groupEnd();// end of experiments with new stuff
		
                /////////
                //problems:
				console.groupCollapsed('Known problems');
                /*
                 console.log('object style');
                 console.log('result:',yAllDivs.style);//wrong - returns proxied yes
                 
                 console.log('object dataset');
                 console.log('result:',yAllDivs.dataset);//wrong - returns proxied yes
                 */
				console.groupEnd();//Known problems

            }());

		</script>
    </body>
</html>    